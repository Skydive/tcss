<div id="global-loader">
	<div>
		<h1 class="loader-title spinner-above">precess.io</h1>
		<div class="spinner s40 m50"></div>
	</div>
</div>

<header>
	<div class="header">
	<!-- <div class="header" style="position:fixed;top:0;left:0;z-index:999;"> -->
		<div class="content">
			<div id="spin" class="spinner s25">
				<canvas width="25" height="25"></canvas>
			</div>
			<a href="javascript:SKY.History.pushState({}, '/');" class="button title r">precess.io</a>
			<!-- <a href="javascript:SKY.History.pushState({}, '/philosophy');" class="button g">philosophy</a> -->
			<!-- <a href="javascript:SKY.History.pushState({}, '/projects');" class="button b">projects</a> -->
			<!-- <a href="javascript:SKY.History.pushState({}, '/team');" class="button p">the team</a> -->
			<!-- <a href="javascript:SKY.History.pushState({}, '/login');" class="login button o">login</a> -->
			<a href="javascript:SKY.History.pushState({}, '/dashboard');" class="logout button o">dashboard</a>
			<a href="javascript:Lib.Ajax.Raven.Redirect({redirect_url: 'https://'+window.location.hostname+'/atlas'}).done(function(json) {window.location.href=json.auth_url;});" class="login button o">login</a>

			
			<a href="javascript:Lib.Ajax.Session.Destroy();window.location.href='https://'+window.location.hostname;" class="logout button o">logout</a>
		</div>
	</div>
</header>

<script>
$(SKY.History).on('construct', function(e, data) {
	$(window).trigger('token_validate');
});
$(window).on('user_session_created', function(e, data) {
	$(".login").hide();
	$(".logout").show();
});
$(window).on('user_session_destroyed', function(e, data) {
	$(".login").show();
	$(".logout").hide();
});
</script>

<div class="atlas bg small" style="position:fixed;bottom:25px;right:25px;">
	<div>
		<svg class="avatar" style="width:72px;height:72px;"></svg>
	</div>
	<div class="content">
		<span class="title"></span>
		<span class="college"></span>
		<span class="group"></span>
	</div>
</div>
<script>
$(".atlas.small").one('click', function() {
	SKY.History.pushState({}, '/atlas');
});

$(window).on('user_atlas_success', function(e, data) {
	$(".atlas .title").text(data.display_name);
	$(".atlas .college").text(data.college+" ("+data.crsid+")");

	//$(".atlas .avatar").jdenticon(data.crsid);
	$(".atlas .avatar").attr('data-jdenticon-value', data.crsid);
	$(".atlas.small").fadeIn(250);
});
$(window).on('user_group_success', function(e, data) {
	$(".atlas .group").text(data.display_name);
});
$(window).on('user_session_destroyed', function(e, data) {
	$(".atlas.small").hide();
});

</script>
